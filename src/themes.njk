---
title: "Theme Builder"
layout: base.njk
description: "Create and customize your own color theme."
---

<div class="theme-builder">
    <h1>Theme Builder</h1>
    <p>Create your own color theme. Changes preview in real-time. Export as JSON when done.</p>

    <div class="builder-layout">
        <div class="builder-controls">
            <div class="control-section">
                <h3>Base Colors</h3>
                <div class="color-row">
                    <label for="tb-bg">Background</label>
                    <input type="color" id="tb-bg" value="#0A0D24">
                    <input type="text" id="tb-bg-hex" value="#0A0D24" class="hex-input">
                </div>
                <div class="color-row">
                    <label for="tb-text">Text</label>
                    <input type="color" id="tb-text" value="#F3E9FF">
                    <input type="text" id="tb-text-hex" value="#F3E9FF" class="hex-input">
                </div>
                <div class="color-row">
                    <label for="tb-heading">Heading</label>
                    <input type="color" id="tb-heading" value="#7FD7FF">
                    <input type="text" id="tb-heading-hex" value="#7FD7FF" class="hex-input">
                </div>
                <div class="color-row">
                    <label for="tb-link">Link</label>
                    <input type="color" id="tb-link" value="#FF5DA2">
                    <input type="text" id="tb-link-hex" value="#FF5DA2" class="hex-input">
                </div>
                <div class="color-row">
                    <label for="tb-primary">Primary</label>
                    <input type="color" id="tb-primary" value="#FF5DA2">
                    <input type="text" id="tb-primary-hex" value="#FF5DA2" class="hex-input">
                </div>
                <div class="color-row">
                    <label for="tb-surface">Surface</label>
                    <input type="color" id="tb-surface" value="#15183A">
                    <input type="text" id="tb-surface-hex" value="#15183A" class="hex-input">
                </div>
                <div class="color-row">
                    <label for="tb-border">Border</label>
                    <input type="color" id="tb-border" value="#2A2E5A">
                    <input type="text" id="tb-border-hex" value="#2A2E5A" class="hex-input">
                </div>
            </div>

            <div class="control-section">
                <h3>Syntax Highlighting</h3>
                <div class="color-row">
                    <label for="tb-sh-keyword">Keyword</label>
                    <input type="color" id="tb-sh-keyword" value="#7FD7FF">
                    <input type="text" id="tb-sh-keyword-hex" value="#7FD7FF" class="hex-input">
                </div>
                <div class="color-row">
                    <label for="tb-sh-string">String</label>
                    <input type="color" id="tb-sh-string" value="#FFE98A">
                    <input type="text" id="tb-sh-string-hex" value="#FFE98A" class="hex-input">
                </div>
                <div class="color-row">
                    <label for="tb-sh-function">Function</label>
                    <input type="color" id="tb-sh-function" value="#FF5DA2">
                    <input type="text" id="tb-sh-function-hex" value="#FF5DA2" class="hex-input">
                </div>
                <div class="color-row">
                    <label for="tb-sh-variable">Variable</label>
                    <input type="color" id="tb-sh-variable" value="#F3E9FF">
                    <input type="text" id="tb-sh-variable-hex" value="#F3E9FF" class="hex-input">
                </div>
                <div class="color-row">
                    <label for="tb-sh-comment">Comment</label>
                    <input type="color" id="tb-sh-comment" value="#8A7FAF">
                    <input type="text" id="tb-sh-comment-hex" value="#8A7FAF" class="hex-input">
                </div>
            </div>

            <div class="control-section">
                <h3>Actions</h3>
                <div class="builder-actions">
                    <button id="tb-random" class="builder-btn">Random</button>
                    <button id="tb-apply" class="builder-btn primary">Apply Theme</button>
                    <button id="tb-export" class="builder-btn">Export JSON</button>
                    <button id="tb-reset" class="builder-btn">Reset</button>
                </div>
                <div class="mode-toggle">
                    <label>Editing Mode:</label>
                    <button id="tb-mode-dark" class="mode-btn active">Dark</button>
                    <button id="tb-mode-light" class="mode-btn">Light</button>
                </div>
            </div>
        </div>

        <div class="builder-preview">
            <h3>Preview</h3>
            <div class="preview-card">
                <div class="preview-header">
                    <span class="preview-title">Sample Post Title</span>
                    <span class="preview-date">January 1, 2025</span>
                </div>
                <p class="preview-text">This is how your body text will appear. It should be readable against the background color you've chosen.</p>
                <p class="preview-text">Here's a <a href="#" class="preview-link">sample link</a> to see link colors in action.</p>
                <div class="preview-code">
                    <pre><code><span class="token keyword">const</span> <span class="token variable">greeting</span> <span class="token punctuation">=</span> <span class="token string">"Hello, World!"</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Print the greeting</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token variable">greeting</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                </div>
                <div class="preview-tags">
                    <span class="preview-tag">#javascript</span>
                    <span class="preview-tag">#tutorial</span>
                </div>
            </div>
        </div>
    </div>

    <div class="export-modal" id="export-modal">
        <div class="modal-content">
            <h3>Theme JSON</h3>
            <p>Copy this JSON and add it to your themes.js file:</p>
            <textarea id="export-json" readonly></textarea>
            <div class="modal-actions">
                <button id="copy-json" class="builder-btn primary">Copy to Clipboard</button>
                <button id="close-modal" class="builder-btn">Close</button>
            </div>
        </div>
    </div>
</div>

<style>
.theme-builder {
    max-width: 1200px;
    margin: 0 auto;
}

.theme-builder h1 {
    color: var(--heading-color);
    margin-bottom: 0.5rem;
}

.theme-builder > p {
    color: var(--tertiary-color);
    margin-bottom: 2rem;
}

.builder-layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
}

@media (max-width: 900px) {
    .builder-layout {
        grid-template-columns: 1fr;
    }
}

.builder-controls {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.control-section {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 1.25rem;
}

.control-section h3 {
    color: var(--heading-color);
    font-size: 1rem;
    margin: 0 0 1rem 0;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--border-color);
}

.color-row {
    display: grid;
    grid-template-columns: 100px 40px 1fr;
    gap: 0.75rem;
    align-items: center;
    margin-bottom: 0.75rem;
}

.color-row:last-child {
    margin-bottom: 0;
}

.color-row label {
    color: var(--text-color);
    font-size: 0.9rem;
}

.color-row input[type="color"] {
    width: 40px;
    height: 32px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    cursor: pointer;
    padding: 2px;
    background: var(--card-bg);
}

.hex-input {
    font-family: var(--font-family-monospace);
    font-size: 0.85rem;
    padding: 0.4rem 0.6rem;
    background: var(--bg-color);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    color: var(--text-color);
    text-transform: uppercase;
}

.hex-input:focus {
    outline: none;
    border-color: var(--primary-color);
}

.builder-actions {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
}

.builder-btn {
    padding: 0.6rem 1.2rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background: var(--card-bg);
    color: var(--text-color);
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.2s ease;
}

.builder-btn:hover {
    border-color: var(--primary-color);
}

.builder-btn.primary {
    background: var(--primary-color);
    border-color: var(--primary-color);
    color: var(--bg-color);
}

.builder-btn.primary:hover {
    opacity: 0.9;
}

.mode-toggle {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-color);
}

.mode-toggle label {
    color: var(--tertiary-color);
    font-size: 0.85rem;
}

.mode-btn {
    padding: 0.4rem 0.8rem;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background: transparent;
    color: var(--text-color);
    cursor: pointer;
    font-size: 0.85rem;
    transition: all 0.2s ease;
}

.mode-btn.active {
    background: var(--primary-color);
    border-color: var(--primary-color);
    color: var(--bg-color);
}

.builder-preview {
    position: sticky;
    top: 80px;
}

.builder-preview h3 {
    color: var(--heading-color);
    font-size: 1rem;
    margin: 0 0 1rem 0;
}

.preview-card {
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 1.5rem;
    background: var(--card-bg);
}

.preview-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 1rem;
}

.preview-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--heading-color);
}

.preview-date {
    font-size: 0.85rem;
    color: var(--tertiary-color);
}

.preview-text {
    color: var(--text-color);
    line-height: 1.6;
    margin-bottom: 1rem;
}

.preview-link {
    color: var(--link-color);
}

.preview-code {
    background: var(--sh-bg, var(--card-bg));
    border: 1px solid var(--sh-border, var(--border-color));
    border-radius: 6px;
    padding: 1rem;
    margin-bottom: 1rem;
    overflow-x: auto;
}

.preview-code pre {
    margin: 0;
    font-family: var(--font-family-monospace);
    font-size: 0.85rem;
    line-height: 1.5;
}

.preview-code code {
    color: var(--sh-text, var(--text-color));
}

.preview-code .token.keyword { color: var(--sh-keyword); }
.preview-code .token.string { color: var(--sh-string); }
.preview-code .token.function { color: var(--sh-function); }
.preview-code .token.variable { color: var(--sh-variable); }
.preview-code .token.comment { color: var(--sh-comment); font-style: italic; }
.preview-code .token.punctuation { color: var(--sh-punctuation, var(--text-color)); }

.preview-tags {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.preview-tag {
    font-size: 0.8rem;
    padding: 0.25rem 0.5rem;
    background: var(--secondary-container-bg, var(--border-color));
    color: var(--primary-color);
    border-radius: 4px;
}

/* Export Modal */
.export-modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    z-index: 1000;
    align-items: center;
    justify-content: center;
}

.export-modal.active {
    display: flex;
}

.modal-content {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    max-width: 600px;
    width: 90%;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
}

.modal-content h3 {
    color: var(--heading-color);
    margin: 0 0 0.5rem 0;
}

.modal-content p {
    color: var(--tertiary-color);
    font-size: 0.9rem;
    margin-bottom: 1rem;
}

#export-json {
    flex: 1;
    min-height: 300px;
    font-family: var(--font-family-monospace);
    font-size: 0.8rem;
    background: var(--bg-color);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    padding: 1rem;
    color: var(--text-color);
    resize: none;
}

.modal-actions {
    display: flex;
    gap: 0.75rem;
    margin-top: 1rem;
    justify-content: flex-end;
}
</style>

<script>
(function() {
    'use strict';

    // Color properties mapping
    const COLOR_MAP = {
        'tb-bg': 'bg',
        'tb-text': 'text',
        'tb-heading': 'heading',
        'tb-link': 'link',
        'tb-primary': 'primary',
        'tb-surface': 'surface',
        'tb-border': 'border',
        'tb-sh-keyword': 'shKeyword',
        'tb-sh-string': 'shString',
        'tb-sh-function': 'shFunction',
        'tb-sh-variable': 'shVariable',
        'tb-sh-comment': 'shComment'
    };

    // CSS variable mapping
    const CSS_VAR_MAP = {
        'bg': '--bg-color',
        'text': '--text-color',
        'heading': '--heading-color',
        'link': '--link-color',
        'primary': '--primary-color',
        'surface': '--card-bg',
        'border': '--border-color',
        'shKeyword': '--sh-keyword',
        'shString': '--sh-string',
        'shFunction': '--sh-function',
        'shVariable': '--sh-variable',
        'shComment': '--sh-comment'
    };

    // Current theme state
    let currentMode = 'dark';
    let themeData = {
        dark: {},
        light: {}
    };

    // Initialize from default theme (Star Lord)
    const defaultDark = {
        bg: '#0A0D24', text: '#F3E9FF', heading: '#7FD7FF', link: '#FF5DA2',
        primary: '#FF5DA2', surface: '#15183A', border: '#2A2E5A',
        shKeyword: '#7FD7FF', shString: '#FFE98A', shFunction: '#FF5DA2',
        shVariable: '#F3E9FF', shComment: '#8A7FAF'
    };

    const defaultLight = {
        bg: '#F7F3FF', text: '#241A3D', heading: '#0D6FB8', link: '#FF3D8E',
        primary: '#FF3D8E', surface: '#FFFFFF', border: '#D5CCF0',
        shKeyword: '#0D6FB8', shString: '#B85A00', shFunction: '#FF3D8E',
        shVariable: '#241A3D', shComment: '#8A7FAF'
    };

    themeData.dark = { ...defaultDark };
    themeData.light = { ...defaultLight };

    // Material Design 2014 Color Palette (same as theming.js)
    const MATERIAL_PALETTE = {
        red:        { 900: '#B71C1C', 700: '#D32F2F', 500: '#F44336', 300: '#E57373', 100: '#FFCDD2', 50: '#FFEBEE', A200: '#FF5252', A400: '#FF1744' },
        pink:       { 900: '#880E4F', 700: '#C2185B', 500: '#E91E63', 300: '#F06292', 100: '#F8BBD0', 50: '#FCE4EC', A200: '#FF4081', A400: '#F50057' },
        purple:     { 900: '#4A148C', 700: '#7B1FA2', 500: '#9C27B0', 300: '#BA68C8', 100: '#E1BEE7', 50: '#F3E5F5', A200: '#E040FB', A400: '#D500F9' },
        deepPurple: { 900: '#311B92', 700: '#512DA8', 500: '#673AB7', 300: '#9575CD', 100: '#D1C4E9', 50: '#EDE7F6', A200: '#7C4DFF', A400: '#651FFF' },
        indigo:     { 900: '#1A237E', 700: '#303F9F', 500: '#3F51B5', 300: '#7986CB', 100: '#C5CAE9', 50: '#E8EAF6', A200: '#536DFE', A400: '#3D5AFE' },
        blue:       { 900: '#0D47A1', 700: '#1976D2', 500: '#2196F3', 300: '#64B5F6', 100: '#BBDEFB', 50: '#E3F2FD', A200: '#448AFF', A400: '#2979FF' },
        lightBlue:  { 900: '#01579B', 700: '#0288D1', 500: '#03A9F4', 300: '#4FC3F7', 100: '#B3E5FC', 50: '#E1F5FE', A200: '#40C4FF', A400: '#00B0FF' },
        cyan:       { 900: '#006064', 700: '#0097A7', 500: '#00BCD4', 300: '#4DD0E1', 100: '#B2EBF2', 50: '#E0F7FA', A200: '#18FFFF', A400: '#00E5FF' },
        teal:       { 900: '#004D40', 700: '#00796B', 500: '#009688', 300: '#4DB6AC', 100: '#B2DFDB', 50: '#E0F2F1', A200: '#64FFDA', A400: '#1DE9B6' },
        green:      { 900: '#1B5E20', 700: '#388E3C', 500: '#4CAF50', 300: '#81C784', 100: '#C8E6C9', 50: '#E8F5E9', A200: '#69F0AE', A400: '#00E676' },
        lightGreen: { 900: '#33691E', 700: '#689F38', 500: '#8BC34A', 300: '#AED581', 100: '#DCEDC8', 50: '#F1F8E9', A200: '#B2FF59', A400: '#76FF03' },
        lime:       { 900: '#827717', 700: '#AFB42B', 500: '#CDDC39', 300: '#DCE775', 100: '#F0F4C3', 50: '#F9FBE7', A200: '#EEFF41', A400: '#C6FF00' },
        yellow:     { 900: '#F57F17', 700: '#FBC02D', 500: '#FFEB3B', 300: '#FFF176', 100: '#FFF9C4', 50: '#FFFDE7', A200: '#FFFF00', A400: '#FFEA00' },
        amber:      { 900: '#FF6F00', 700: '#FFA000', 500: '#FFC107', 300: '#FFD54F', 100: '#FFECB3', 50: '#FFF8E1', A200: '#FFD740', A400: '#FFC400' },
        orange:     { 900: '#E65100', 700: '#F57C00', 500: '#FF9800', 300: '#FFB74D', 100: '#FFE0B2', 50: '#FFF3E0', A200: '#FFAB40', A400: '#FF9100' },
        deepOrange: { 900: '#BF360C', 700: '#E64A19', 500: '#FF5722', 300: '#FF8A65', 100: '#FFCCBC', 50: '#FBE9E7', A200: '#FF6E40', A400: '#FF3D00' },
        grey:       { 900: '#212121', 700: '#616161', 500: '#9E9E9E', 300: '#E0E0E0', 100: '#F5F5F5', 50: '#FAFAFA' }
    };

    // Color wheel order (chromatic colors only, arranged by hue)
    const COLOR_WHEEL = [
        'red', 'pink', 'purple', 'deepPurple', 'indigo', 'blue',
        'lightBlue', 'cyan', 'teal', 'green', 'lightGreen', 'lime',
        'yellow', 'amber', 'orange', 'deepOrange'
    ];

    // Color relationship types
    const RELATIONSHIPS = ['analogous', 'complementary', 'triadic'];

    // Helper functions for color generation
    function pickRandom(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
    }

    function getColorAtPosition(position) {
        const len = COLOR_WHEEL.length;
        const wrappedPos = ((position % len) + len) % len;
        return COLOR_WHEEL[wrappedPos];
    }

    function getRelatedColor(primaryName, relationship) {
        const primaryPos = COLOR_WHEEL.indexOf(primaryName);
        let offset;

        switch (relationship) {
            case 'analogous':
                offset = pickRandom([1, 2, -1, -2]);
                break;
            case 'complementary':
                offset = 8; // 180° on 16-color wheel
                break;
            case 'triadic':
                offset = pickRandom([5, -5, 6, -6]); // ~120°
                break;
            default:
                offset = 1;
        }

        return getColorAtPosition(primaryPos + offset);
    }

    // Generate random colors using Material Design color theory
    function generateRandomColors(mode) {
        const primaryName = pickRandom(COLOR_WHEEL);
        const relationship = pickRandom(RELATIONSHIPS);
        const accentName = getRelatedColor(primaryName, relationship);

        const primary = MATERIAL_PALETTE[primaryName];
        const accent = MATERIAL_PALETTE[accentName];

        if (mode === 'dark') {
            return {
                bg: primary[900],
                text: primary[50],
                heading: accent[300] || accent[100],
                link: accent.A200 || accent[300],
                primary: accent.A400 || accent[500],
                surface: primary[700] || primary[900],
                border: primary[500] || primary[700],
                shKeyword: accent.A200 || accent[300],
                shString: accent[100] || accent[300],
                shFunction: accent[300] || accent[500],
                shVariable: primary[100],
                shComment: primary[500] || primary[300]
            };
        } else {
            return {
                bg: primary[50],
                text: primary[900],
                heading: accent[700] || accent[900],
                link: accent[700] || accent[500],
                primary: accent[500],
                surface: '#FFFFFF',
                border: primary[100],
                shKeyword: accent[700] || accent[500],
                shString: accent[900] || accent[700],
                shFunction: accent[500],
                shVariable: primary[700],
                shComment: MATERIAL_PALETTE.grey[500]
            };
        }
    }

    // Sync color picker and hex input
    function syncColorInputs(colorId, value) {
        const picker = document.getElementById(colorId);
        const hex = document.getElementById(colorId + '-hex');
        if (picker) picker.value = value;
        if (hex) hex.value = value.toUpperCase();
    }

    // Get current colors from inputs
    function getCurrentColors() {
        const colors = {};
        for (const [inputId, propName] of Object.entries(COLOR_MAP)) {
            const picker = document.getElementById(inputId);
            if (picker) colors[propName] = picker.value;
        }
        return colors;
    }

    // Load colors into inputs
    function loadColorsToInputs(colors) {
        for (const [inputId, propName] of Object.entries(COLOR_MAP)) {
            if (colors[propName]) {
                syncColorInputs(inputId, colors[propName]);
            }
        }
    }

    // Apply colors to preview (and optionally full page)
    function applyPreview(colors, fullPage = false) {
        const root = fullPage ? document.documentElement : document.querySelector('.preview-card');
        if (!root) return;

        for (const [propName, cssVar] of Object.entries(CSS_VAR_MAP)) {
            if (colors[propName]) {
                root.style.setProperty(cssVar, colors[propName]);
            }
        }

        // Also set derived colors
        if (colors.bg && colors.text) {
            root.style.setProperty('--tertiary-color', `color-mix(in srgb, ${colors.text} 70%, ${colors.bg})`);
            root.style.setProperty('--search-bg', colors.bg);
            root.style.setProperty('--sh-bg', colors.surface);
            root.style.setProperty('--sh-border', colors.border);
            root.style.setProperty('--sh-text', colors.text);
            root.style.setProperty('--sh-punctuation', colors.text);
            root.style.setProperty('--secondary-container-bg', colors.border);

            // Set glass/shadow colors based on mode for sidebar and other glass effects
            if (fullPage) {
                const isDark = currentMode === 'dark';
                root.style.setProperty('--glass-bg', isDark ? 'rgba(255, 255, 255, 0.05)' : 'rgba(0, 0, 0, 0.03)');
                root.style.setProperty('--glass-border', isDark ? 'rgba(255, 255, 255, 0.08)' : 'rgba(0, 0, 0, 0.08)');
                root.style.setProperty('--shadow-color', isDark ? 'rgba(0, 0, 0, 0.35)' : 'rgba(0, 0, 0, 0.12)');
                root.style.setProperty('--grid-line', isDark ? 'rgba(255, 255, 255, 0.06)' : 'rgba(0, 0, 0, 0.06)');
            }
        }
    }

    // Initialize event listeners
    function init() {
        // Load initial colors
        loadColorsToInputs(themeData[currentMode]);
        applyPreview(themeData[currentMode]);

        // Color picker change
        for (const inputId of Object.keys(COLOR_MAP)) {
            const picker = document.getElementById(inputId);
            const hex = document.getElementById(inputId + '-hex');

            if (picker) {
                picker.addEventListener('input', (e) => {
                    syncColorInputs(inputId, e.target.value);
                    themeData[currentMode] = getCurrentColors();
                    applyPreview(themeData[currentMode]);
                });
            }

            if (hex) {
                hex.addEventListener('input', (e) => {
                    let value = e.target.value.trim();
                    if (!value.startsWith('#')) value = '#' + value;
                    if (/^#[0-9A-Fa-f]{6}$/.test(value)) {
                        syncColorInputs(inputId, value);
                        themeData[currentMode] = getCurrentColors();
                        applyPreview(themeData[currentMode]);
                    }
                });

                hex.addEventListener('blur', (e) => {
                    const picker = document.getElementById(inputId);
                    if (picker) e.target.value = picker.value.toUpperCase();
                });
            }
        }

        // Mode toggle
        const darkBtn = document.getElementById('tb-mode-dark');
        const lightBtn = document.getElementById('tb-mode-light');

        darkBtn?.addEventListener('click', () => {
            themeData[currentMode] = getCurrentColors();
            currentMode = 'dark';
            darkBtn.classList.add('active');
            lightBtn.classList.remove('active');
            loadColorsToInputs(themeData.dark);
            applyPreview(themeData.dark);
        });

        lightBtn?.addEventListener('click', () => {
            themeData[currentMode] = getCurrentColors();
            currentMode = 'light';
            lightBtn.classList.add('active');
            darkBtn.classList.remove('active');
            loadColorsToInputs(themeData.light);
            applyPreview(themeData.light);
        });

        // Apply button - applies to full page
        document.getElementById('tb-apply')?.addEventListener('click', () => {
            themeData[currentMode] = getCurrentColors();
            applyPreview(themeData[currentMode], true);
            document.documentElement.setAttribute('data-theme-set', 'custom');
            document.documentElement.setAttribute('data-mode', currentMode);

            // Clear random theme state
            if (window.BlogApp && BlogApp.state) {
                BlogApp.state.randomTheme = null;
            }
        });

        // Random button - generates random colors using Material Design color theory
        document.getElementById('tb-random')?.addEventListener('click', () => {
            const randomColors = generateRandomColors(currentMode);
            themeData[currentMode] = randomColors;
            loadColorsToInputs(randomColors);
            applyPreview(randomColors);
        });

        // Reset button
        document.getElementById('tb-reset')?.addEventListener('click', () => {
            themeData.dark = { ...defaultDark };
            themeData.light = { ...defaultLight };
            loadColorsToInputs(themeData[currentMode]);
            applyPreview(themeData[currentMode]);
        });

        // Export button
        document.getElementById('tb-export')?.addEventListener('click', () => {
            themeData[currentMode] = getCurrentColors();
            const json = generateJSON();
            document.getElementById('export-json').value = json;
            document.getElementById('export-modal').classList.add('active');
        });

        // Close modal
        document.getElementById('close-modal')?.addEventListener('click', () => {
            document.getElementById('export-modal').classList.remove('active');
        });

        // Copy JSON
        document.getElementById('copy-json')?.addEventListener('click', () => {
            const textarea = document.getElementById('export-json');
            textarea.select();
            document.execCommand('copy');
            const btn = document.getElementById('copy-json');
            const original = btn.textContent;
            btn.textContent = 'Copied!';
            setTimeout(() => btn.textContent = original, 2000);
        });

        // Close modal on backdrop click
        document.getElementById('export-modal')?.addEventListener('click', (e) => {
            if (e.target.id === 'export-modal') {
                e.target.classList.remove('active');
            }
        });
    }

    // Generate JSON export
    function generateJSON() {
        const themeName = 'my-custom-theme';
        const output = {
            id: themeName,
            name: 'My Custom Theme',
            dark: themeData.dark,
            light: themeData.light
        };

        return JSON.stringify(output, null, 2);
    }

    // Run init when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
})();
</script>
